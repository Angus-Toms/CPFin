#include "example.hpp"

#include <chrono>
#include <iostream>
#include "overlays/sma.hpp"
#include "overlays/bollinger.hpp"
#include "timeseries/ar.hpp"
#include "timeseries/ma.hpp"

#include "priceseries.hpp"

int main() {
  // // Fetch data
  // const auto ps = PriceSeries::getPriceSeries("AAPL", "2020-01-01", "2020-12-31");

  // // Add indicators
  // ps->addRSI();
  // ps->addBollingerBands();

  // // View and export results 
  // ps->plot();
  // ps->exportCSV("aapl.csv");

  // Eigen test 
  // Test mu, theta values are -1, 1.5
  std::vector<double> data = {1.223563989895451, -1.2625547329283218, -0.7215377056932437, 0.8397292288840593, -1.5088448453910188, 0.6696751053589262, 1.5643944701709853, 1.8541459647994771, 0.5427746081149127, 0.9273909701952017, 1.8234131973811285, -0.5610534376797867, -0.1546454316463174, -0.10888487787554468, -0.7221190386479428, 2.377702769036916, 0.6049482526849731, -3.0524079291140014, 0.36147815470358, 3.790458610579148, 1.6581485115242844, 0.7415961486748592, -0.28099898965953973, -1.913018272305668, 1.0339029506022752, 0.3175458736118574, -1.4021267353640134, 1.6257194452378696, 0.9544954193656248, -1.3724902655244058, 0.5818146104038571, 0.9938787334423012, -1.1961187409287097, -0.058363407859653244, 3.3115443133994504, 0.08043734536312053, -1.7918211834942335, 2.166645479377445, 2.5806630414822824, -1.80599453488941, 0.07999634065492389, 2.0025455909213363, 1.3865215384846725, -0.3430055992747185, -1.2587899356086938, 0.8178421449024555, 0.41523998749865687, -1.9020534733793624, -0.2558014556836533, 3.09909928117458, 0.28805224116250233, -2.062559986379463, 0.6993804414142384, 2.7697659882083974, 0.5051123012073546, -0.5792538107734346, 0.15768684548411066, 0.2736564414976105, 0.45256656113966076, 2.329220994136429, 1.4158896337969673, 0.5179272862388076, 0.47876013232988407, -0.14197941289329885, -2.2071337182667072, -0.07465108590239813, 1.6951128190309768, -0.06753868170797261, 0.31614935773331926, -0.7882221538448021, -0.25220208829401347, 2.401694136945174, 1.1660912579906524, -1.5260460124253739, 0.32807084367772144, 3.185252037495233, 0.55169836444538, 0.6015600576052023, 2.138655602635554, 0.0668709321607416, 0.31428541448775804, 0.17465075642761235, 0.49152498363350006, 0.054298386538565, -0.9187418190090861, 0.5935957501990811, 0.8183338967981123, 0.2832091951932162, 1.370821516706219, 0.5281606286732459, -2.014047079776434, 0.9504993898655937, 1.3755088500933825, -1.8574720515345238, 1.2650711355233994, 3.5720662727183363, 0.5127705063988297, -1.1842320165645406, -0.5882003214166913, 1.0182224908255084, 1.7783397784425972, 0.3513847639216935, 0.46143997642162726, 1.9629940196346785, 1.1273084799047959, -0.4925010085967168, -0.05716709416622401, 0.8682651535877816, 2.0601669326669256, 1.1066577322960778, -0.710293173071574, -0.35539986510497495, -1.4372142175130866, -0.4189067794345181, 0.9571014836462726, 1.9698669482083422, 1.3015034371422733, -1.068125141915449, 0.9164031910463502, 0.6750911655211906, 0.4395555425790315, -0.38554564747165454, -0.0415372807666034, 0.6927341522044979, 0.011800481864525397, -1.2758439178413254, -1.3603520136149945, 0.9487567784639901, 2.7678611542355966, 2.1062994673919375, -2.57952268819617, 0.28660059096181556, 2.5330239381568296, 0.5496201241972953, -0.09293171835515923, 0.8562770931457898, 3.073649150272408, 0.11191367221120607, 0.06134056813368083, 1.461158671980497, 2.1145919226548444, 1.080064715147812, 0.2352277700167521, 0.6427066193269004, 1.3787192833192474, -0.8708456783806797, -1.120019252281728, 3.5072724897151355, 2.5166952623041134, -0.4496026184535117, -0.1139362986611373, -0.1777554285130043, 1.5095328012902391, 0.9331106298583959, 1.2695411025595167, -1.558032494170453, 0.02125062333854899, 2.8135968326584, -1.0573737987316223, 0.7233808671326756, 0.7210904429221032, -1.0046788173914993, 0.16524189420830782, 1.319750378793195, 1.7548936316768131, -0.8035946001275294, -0.5482017803859313, 2.7394525282336404, 0.8110641381371544, 0.46695123088174095, -1.2109678398153374, 0.6803772622550124, 2.311197951615612, -0.6060841417566745, 0.7885720973340626, 1.7522463604040401, -0.2736857071792435, 1.1950067124973711, 3.2876842086497815, 0.0727088675722869, -0.44971339439109254, 1.3070992747416563, -0.03690402709914431, -1.25729227425892, -0.7177327647793437, 0.9299575057347245, -0.2687007045724821, -1.2558109251345895, 2.2218288637023145, 1.5361666551257118, 0.3701527517047497, 0.6183551064820639, 0.9401528217049717, 0.15652594716587154, -0.2126580898535128, 0.33665880103740786, 0.4922936673982323, 2.7862764962419777, 0.6609123660951799, -1.9269249482693627, -1.4223326554032354, 1.4788245239539795, 1.677570655224594, -0.6719996990666034, -0.3707461340459579, -0.9478195670862521, 0.5550331620558043, 1.5003389680247043, 1.3530561176321285, 0.560213467507819, -1.4208924697802632, 1.0593027989201635, 1.5132839503544735, 0.8096709047034556, 1.1776634181373469, 1.6269772758566658, -0.4541724780961294, -2.2007950695490264, 0.3673578409378064, 0.9819711414213512, 1.7959842294387758, 0.4269438770722239, -0.3749988395287024, 1.2999708097818106, 0.9249451077911651, -0.35017007106746134, -0.7858666715541363, 0.12608453869800568, 2.0714086599899835, -0.3348036743823497, -1.5015305564181147, 1.466985998103426, 0.9551239375637459, -0.8821407728169571, 0.3754482705017228, 1.8430505663825167, 1.5263076667881703, -0.08539650989929937, -0.28120425973181085, 1.8049901275037519, 1.5175807286999687, 1.0220214004263803, -0.37945762179691755, 0.4651279075836232, 1.770104905890264, -0.7485646791417218, -0.38536847315567974, 1.8968010190738545, 1.3766104987122032, 0.24785651720781338};
  MA ma(data);

  ma.train(3);

  return 0;
}